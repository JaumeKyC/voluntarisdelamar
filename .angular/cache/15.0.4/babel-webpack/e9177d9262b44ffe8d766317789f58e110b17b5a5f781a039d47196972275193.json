{"ast":null,"code":"import { forkJoin } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/actividades.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/common\";\nconst _c0 = function (a0) {\n  return {\n    \"pointer-events\": a0\n  };\n};\nfunction ListaEventoVoluntarioComponent_div_6_div_1_button_29_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function ListaEventoVoluntarioComponent_div_6_div_1_button_29_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const item_r1 = i0.ɵɵnextContext(2).$implicit;\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.unirse(item_r1.VOLUNTARIOS, item_r1.MAX_VOLUNTARIOS));\n    });\n    i0.ɵɵtext(1, \"PARTICIPAR\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext(3);\n    i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(2, _c0, ctx_r4.isDisabled ? \"none\" : \"auto\"))(\"disabled\", ctx_r4.isDisabled);\n  }\n}\nfunction ListaEventoVoluntarioComponent_div_6_div_1_ng_template_30_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 19);\n    i0.ɵɵtext(1, \"SE HA UNIDO AL EVENTO\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function ListaEventoVoluntarioComponent_div_6_div_1_ng_template_30_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r12);\n      const item_r1 = i0.ɵɵnextContext(2).$implicit;\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.desunirse(item_r1.ID));\n    });\n    i0.ɵɵtext(3, \"ABANDONAR\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ListaEventoVoluntarioComponent_div_6_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 7)(2, \"div\", 8)(3, \"h4\", 9);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"p\", 10);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"span\", 11);\n    i0.ɵɵtext(8, \"LUGAR\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"p\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"div\", 12)(12, \"div\", 13)(13, \"span\", 11);\n    i0.ɵɵtext(14, \"FECHA INICIO\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"p\");\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"div\", 13)(18, \"span\", 11);\n    i0.ɵɵtext(19, \"HORA INICIO\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"p\");\n    i0.ɵɵtext(21);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(22, \"p\");\n    i0.ɵɵtext(23, \"Voluntarios: \");\n    i0.ɵɵelementStart(24, \"span\", 11);\n    i0.ɵɵtext(25);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(26, \"div\", 14)(27, \"button\", 15);\n    i0.ɵɵlistener(\"click\", function ListaEventoVoluntarioComponent_div_6_div_1_Template_button_click_27_listener() {\n      i0.ɵɵrestoreView(_r15);\n      const item_r1 = i0.ɵɵnextContext().$implicit;\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.detalle(item_r1.ID));\n    });\n    i0.ɵɵtext(28, \"VER\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(29, ListaEventoVoluntarioComponent_div_6_div_1_button_29_Template, 2, 4, \"button\", 16);\n    i0.ɵɵtemplate(30, ListaEventoVoluntarioComponent_div_6_div_1_ng_template_30_Template, 4, 0, \"ng-template\", null, 17, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const _r5 = i0.ɵɵreference(31);\n    const item_r1 = i0.ɵɵnextContext().$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(item_r1.NOMBRE);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r1.OBSERVACIONES);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(item_r1.UBICACION);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(ctx_r3.fechaFormateada);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r3.horaFormateada);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate2(\"\", item_r1.VOLUNTARIOS, \" / \", item_r1.MAX_VOLUNTARIOS, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.unido == false)(\"ngIfElse\", _r5);\n  }\n}\nfunction ListaEventoVoluntarioComponent_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtemplate(1, ListaEventoVoluntarioComponent_div_6_div_1_Template, 32, 9, \"div\", 6);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r1 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", item_r1.ES_FORMACION == false);\n  }\n}\nexport class ListaEventoVoluntarioComponent {\n  constructor(service, router) {\n    this.service = service;\n    this.router = router;\n    this.maximo_voluntarios = 30;\n    this.contador_voluntarios = 15;\n    this.resp = [];\n    this.isDisabled = false;\n    this.unido = false;\n    this.id = sessionStorage.getItem('id');\n    this.horaFormateada = \"\";\n    this.fechaFormateada = \"\";\n  }\n  ngOnInit() {\n    this.getListadoEventos();\n    if (this.contador_voluntarios >= this.maximo_voluntarios) {\n      this.isDisabled = true;\n    }\n  }\n  detalle(idEvento) {\n    console.log(idEvento);\n    this.service.getDetalle(idEvento, this.id).subscribe(response => {\n      console.log(response);\n      let fecha = new Date(this.resp[0].FECHA_INICIO);\n      let hora = new Date(this.resp[0].HORA_INICIO);\n      const observables = [localStorage.setItem('nombre_evento', this.resp[0].NOMBRE), localStorage.setItem('lugar_evento', this.resp[0].UBICACION), localStorage.setItem('descripcion_evento', this.resp[0].OBSERVACIONES), localStorage.setItem('fecha_inicio_evento', fecha.toString()), localStorage.setItem('hora_inicio_evento', hora.toString()), localStorage.setItem('voluntarios_evento', this.resp[0].VOLUNTARIOS.toString()), localStorage.setItem('max_voluntarios_evento', this.resp[0].MAX_VOLUNTARIOS.toString()), localStorage.setItem('entidad_organizadora', this.resp[0].ENTIDAD_ORGANIZADORA), localStorage.setItem('num_embarcaciones', this.resp[0].NUM_EMBARCACIONES.toString()), localStorage.setItem('num_motos', this.resp[0].NUM_MOTOS.toString()), localStorage.setItem('num_patrones', this.resp[0].NUM_PATRONES.toString()), localStorage.setItem('num_tripulantes', this.resp[0].NUM_TRIPULANTES.toString()), localStorage.setItem('num_socorristas', this.resp[0].NUM_SOCORRISTAS.toString()), localStorage.setItem('user_joined', this.resp[0].USER_JOINED.toString())];\n      // Combina los observables en uno solo y espera a que todos se completen\n      forkJoin(observables).subscribe(() => {\n        // Todos los setItem() se han completado, podemos cambiar de ruta\n        this.router.navigate(['/detalle_eventos']);\n      });\n    });\n    this.router.navigate(['/detalle_eventos']);\n  }\n  getListadoEventos() {\n    this.service.getActividades(this.id).subscribe(response => {\n      for (let i = 0; i < response.length; i++) {\n        if (response[i].ES_FORMACION != true) {\n          this.resp = response;\n          let hora_inicio = new Date(this.resp[0].HORA_INICIO);\n          let horas = hora_inicio.getHours();\n          let minutos = hora_inicio.getMinutes();\n          let segundos = hora_inicio.getSeconds();\n          this.horaFormateada = `${horas.toString().padStart(2, '0')}:${minutos.toString().padStart(2, '0')}:${segundos.toString().padStart(2, '0')}`;\n          let fecha_inicio = new Date(this.resp[0].FECHA_INICIO);\n          let dia = fecha_inicio.getDate();\n          let mes = fecha_inicio.getMonth() + 1;\n          let any = fecha_inicio.getFullYear();\n          this.fechaFormateada = `${dia.toString().padStart(2, '0')}/${mes.toString().padStart(2, '0')}/${any}`;\n        }\n      }\n    });\n  }\n  unirse(voluntarios, voluntariosMax) {\n    voluntarios++;\n    this.unido = true;\n    if (voluntarios >= voluntariosMax) {\n      this.isDisabled = true;\n    }\n  }\n  desunirse(id) {\n    this.contador_voluntarios--;\n    this.unido = false;\n    if (this.contador_voluntarios >= this.maximo_voluntarios) {\n      this.isDisabled = true;\n    }\n  }\n}\nListaEventoVoluntarioComponent.ɵfac = function ListaEventoVoluntarioComponent_Factory(t) {\n  return new (t || ListaEventoVoluntarioComponent)(i0.ɵɵdirectiveInject(i1.ActividadesService), i0.ɵɵdirectiveInject(i2.Router));\n};\nListaEventoVoluntarioComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ListaEventoVoluntarioComponent,\n  selectors: [[\"app-lista-evento-voluntario\"]],\n  decls: 8,\n  vars: 1,\n  consts: [[1, \"container\"], [1, \"text-center\", \"mt-3\"], [1, \"row\", \"mt-4\"], [1, \"col-2\"], [1, \"col-8\"], [4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [1, \"card\", \"mb-5\"], [1, \"card-body\"], [1, \"card-title\"], [1, \"card-text\"], [\"id\", \"datoResaltado\"], [1, \"row\"], [1, \"col\"], [1, \"d-grid\", \"gap-2\", \"d-md-block\"], [\"id\", \"botonesListado\", \"type\", \"button\", 1, \"btn\", \"mt-1\", \"btn-md\", 2, \"background-color\", \"lightblue\", 3, \"click\"], [\"class\", \"btn mt-1 btn-md\", \"id\", \"botonesListado\", \"style\", \"background-color: #0066ff; color: white\", \"type\", \"button\", 3, \"ngStyle\", \"disabled\", \"click\", 4, \"ngIf\", \"ngIfElse\"], [\"elseBlock\", \"\"], [\"id\", \"botonesListado\", \"type\", \"button\", 1, \"btn\", \"mt-1\", \"btn-md\", 2, \"background-color\", \"#0066ff\", \"color\", \"white\", 3, \"ngStyle\", \"disabled\", \"click\"], [\"id\", \"botonesListado\", \"type\", \"button\", 1, \"btn\", \"mt-1\", \"btn-md\", 2, \"background-color\", \"green\", \"color\", \"white\"], [\"id\", \"botonesListado\", \"type\", \"button\", 1, \"btn\", \"mt-1\", \"btn-md\", 2, \"background-color\", \"red\", \"color\", \"white\", 3, \"click\"]],\n  template: function ListaEventoVoluntarioComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\", 1);\n      i0.ɵɵtext(2, \"EVENTOS\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"div\", 2);\n      i0.ɵɵelement(4, \"div\", 3);\n      i0.ɵɵelementStart(5, \"div\", 4);\n      i0.ɵɵtemplate(6, ListaEventoVoluntarioComponent_div_6_Template, 2, 1, \"div\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(7, \"div\", 3);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngForOf\", ctx.resp);\n    }\n  },\n  dependencies: [i3.NgForOf, i3.NgIf, i3.NgStyle],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"AAIA,SAASA,QAAQ,QAAQ,MAAM;;;;;;;;;;;;;ICyBCC,kCAIkB;IAFdA;MAAAA;MAAA;MAAA;MAAA,OAASA,0EAA6C;IAAA,EAAC;IAEzCA,0BAAU;IAAAA,iBAAS;;;;IAHjCA,yFAA4D;;;;;;IAM5DA,kCACgE;IAAAA,qCACtD;IAAAA,iBAAS;IACnBA,kCAC8D;IADtDA;MAAAA;MAAA;MAAA;MAAA,OAASA,4CAAkB;IAAA,EAAC;IAC0BA,yBAAS;IAAAA,iBAAS;;;;;;IAlCpGA,2BAAwC;IAGLA,YAAe;IAAAA,iBAAK;IAC3CA,6BAAqB;IAAAA,YAAsB;IAAAA,iBAAI;IAC/CA,gCAAyB;IAAAA,qBAAK;IAAAA,iBAAO;IACrCA,yBAAG;IAAAA,aAAkB;IAAAA,iBAAI;IACzBA,gCAAiB;IAEgBA,6BAAY;IAAAA,iBAAO;IAC5CA,0BAAG;IAAAA,aAAmB;IAAAA,iBAAI;IAE9BA,gCAAiB;IACYA,4BAAW;IAAAA,iBAAO;IAC3CA,0BAAG;IAAAA,aAAkB;IAAAA,iBAAI;IAGjCA,0BAAG;IAAAA,8BAAa;IAAAA,iCAAyB;IAAAA,aACT;IAAAA,iBAAO;IACvCA,gCAAqC;IAE7BA;MAAAA;MAAA;MAAA;MAAA,OAASA,0CAAgB;IAAA,EAAC;IACyBA,oBAAG;IAAAA,iBAAS;IACnEA,oGAIqC;IAErCA,+IAMc;IAElBA,iBAAM;;;;;;IAlCiBA,eAAe;IAAfA,oCAAe;IACjBA,eAAsB;IAAtBA,2CAAsB;IAExCA,eAAkB;IAAlBA,uCAAkB;IAIVA,eAAmB;IAAnBA,4CAAmB;IAInBA,eAAkB;IAAlBA,2CAAkB;IAGYA,eACT;IADSA,kFACT;IAKnBA,eAAoB;IAApBA,4CAAoB;;;;;IAxBjDA,2BAA6C;IACzCA,sFAwCM;IACVA,iBAAM;;;;IAzCIA,eAAgC;IAAhCA,oDAAgC;;;ADMtD,OAAM,MAAOC,8BAA8B;EAUzCC,YAA0BC,OAA2B,EAAUC,MAAc;IAAnD,YAAO,GAAPD,OAAO;IAA8B,WAAM,GAANC,MAAM;IAT9D,uBAAkB,GAAW,EAAE;IAC/B,yBAAoB,GAAW,EAAE;IACjC,SAAI,GAAkB,EAAE;IACxB,eAAU,GAAY,KAAK;IAC3B,UAAK,GAAY,KAAK;IACtB,OAAE,GAAQC,cAAc,CAACC,OAAO,CAAC,IAAI,CAAC;IACtC,mBAAc,GAAW,EAAE;IAC3B,oBAAe,GAAW,EAAE;EAE8C;EAEjFC,QAAQ;IACN,IAAI,CAACC,iBAAiB,EAAE;IACxB,IAAI,IAAI,CAACC,oBAAoB,IAAI,IAAI,CAACC,kBAAkB,EAAE;MACxD,IAAI,CAACC,UAAU,GAAG,IAAI;;EAE1B;EAEOC,OAAO,CAACC,QAAgB;IAC7BC,OAAO,CAACC,GAAG,CAACF,QAAQ,CAAC;IACrB,IAAI,CAACV,OAAO,CAACa,UAAU,CAACH,QAAQ,EAAE,IAAI,CAACI,EAAE,CAAC,CAACC,SAAS,CAACC,QAAQ,IAAG;MAC9DL,OAAO,CAACC,GAAG,CAACI,QAAQ,CAAC;MACrB,IAAIC,KAAK,GAAG,IAAIC,IAAI,CAAC,IAAI,CAACC,IAAI,CAAC,CAAC,CAAC,CAACC,YAAY,CAAC;MAC/C,IAAIC,IAAI,GAAG,IAAIH,IAAI,CAAC,IAAI,CAACC,IAAI,CAAC,CAAC,CAAC,CAACG,WAAW,CAAC;MAC7C,MAAMC,WAAW,GAAG,CAClBC,YAAY,CAACC,OAAO,CAAC,eAAe,EAAE,IAAI,CAACN,IAAI,CAAC,CAAC,CAAC,CAACO,MAAM,CAAC,EAC1DF,YAAY,CAACC,OAAO,CAAC,cAAc,EAAE,IAAI,CAACN,IAAI,CAAC,CAAC,CAAC,CAACQ,SAAS,CAAC,EAC5DH,YAAY,CAACC,OAAO,CAAC,oBAAoB,EAAE,IAAI,CAACN,IAAI,CAAC,CAAC,CAAC,CAACS,aAAa,CAAC,EACtEJ,YAAY,CAACC,OAAO,CAAC,qBAAqB,EAAER,KAAK,CAACY,QAAQ,EAAE,CAAC,EAC7DL,YAAY,CAACC,OAAO,CAAC,oBAAoB,EAAEJ,IAAI,CAACQ,QAAQ,EAAE,CAAC,EAC3DL,YAAY,CAACC,OAAO,CAAC,oBAAoB,EAAE,IAAI,CAACN,IAAI,CAAC,CAAC,CAAC,CAACW,WAAW,CAACD,QAAQ,EAAE,CAAC,EAC/EL,YAAY,CAACC,OAAO,CAAC,wBAAwB,EAAE,IAAI,CAACN,IAAI,CAAC,CAAC,CAAC,CAACY,eAAe,CAACF,QAAQ,EAAE,CAAC,EACvFL,YAAY,CAACC,OAAO,CAAC,sBAAsB,EAAE,IAAI,CAACN,IAAI,CAAC,CAAC,CAAC,CAACa,oBAAoB,CAAC,EAC/ER,YAAY,CAACC,OAAO,CAAC,mBAAmB,EAAE,IAAI,CAACN,IAAI,CAAC,CAAC,CAAC,CAACc,iBAAiB,CAACJ,QAAQ,EAAE,CAAC,EACpFL,YAAY,CAACC,OAAO,CAAC,WAAW,EAAE,IAAI,CAACN,IAAI,CAAC,CAAC,CAAC,CAACe,SAAS,CAACL,QAAQ,EAAE,CAAC,EACpEL,YAAY,CAACC,OAAO,CAAC,cAAc,EAAE,IAAI,CAACN,IAAI,CAAC,CAAC,CAAC,CAACgB,YAAY,CAACN,QAAQ,EAAE,CAAC,EAC1EL,YAAY,CAACC,OAAO,CAAC,iBAAiB,EAAE,IAAI,CAACN,IAAI,CAAC,CAAC,CAAC,CAACiB,eAAe,CAACP,QAAQ,EAAE,CAAC,EAChFL,YAAY,CAACC,OAAO,CAAC,iBAAiB,EAAE,IAAI,CAACN,IAAI,CAAC,CAAC,CAAC,CAACkB,eAAe,CAACR,QAAQ,EAAE,CAAC,EAChFL,YAAY,CAACC,OAAO,CAAC,aAAa,EAAE,IAAI,CAACN,IAAI,CAAC,CAAC,CAAC,CAACmB,WAAW,CAACT,QAAQ,EAAE,CAAC,CACzE;MAED;MACAjC,QAAQ,CAAC2B,WAAW,CAAC,CAACR,SAAS,CAAC,MAAK;QACnC;QACA,IAAI,CAACd,MAAM,CAACsC,QAAQ,CAAC,CAAC,kBAAkB,CAAC,CAAC;MAC5C,CAAC,CAAC;IACJ,CAAC,CAAC;IACF,IAAI,CAACtC,MAAM,CAACsC,QAAQ,CAAC,CAAC,kBAAkB,CAAC,CAAC;EAC5C;EAEOlC,iBAAiB;IACtB,IAAI,CAACL,OAAO,CAACwC,cAAc,CAAC,IAAI,CAAC1B,EAAE,CAAC,CAACC,SAAS,CAAEC,QAAe,IAAI;MACjE,KAAK,IAAIyB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGzB,QAAQ,CAAC0B,MAAM,EAAED,CAAC,EAAE,EAAE;QACxC,IAAIzB,QAAQ,CAACyB,CAAC,CAAC,CAACE,YAAY,IAAI,IAAI,EAAE;UACpC,IAAI,CAACxB,IAAI,GAAGH,QAAQ;UACpB,IAAI4B,WAAW,GAAG,IAAI1B,IAAI,CAAC,IAAI,CAACC,IAAI,CAAC,CAAC,CAAC,CAACG,WAAW,CAAC;UACpD,IAAIuB,KAAK,GAAGD,WAAW,CAACE,QAAQ,EAAE;UAClC,IAAIC,OAAO,GAAGH,WAAW,CAACI,UAAU,EAAE;UACtC,IAAIC,QAAQ,GAAGL,WAAW,CAACM,UAAU,EAAE;UACvC,IAAI,CAACC,cAAc,GAAG,GAAGN,KAAK,CAAChB,QAAQ,EAAE,CAACuB,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,IAAIL,OAAO,CAAClB,QAAQ,EAAE,CAACuB,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,IAAIH,QAAQ,CAACpB,QAAQ,EAAE,CAACuB,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE;UAC3I,IAAIC,YAAY,GAAG,IAAInC,IAAI,CAAC,IAAI,CAACC,IAAI,CAAC,CAAC,CAAC,CAACC,YAAY,CAAC;UACtD,IAAIkC,GAAG,GAAGD,YAAY,CAACE,OAAO,EAAE;UAChC,IAAIC,GAAG,GAAGH,YAAY,CAACI,QAAQ,EAAE,GAAG,CAAC;UACrC,IAAIC,GAAG,GAAGL,YAAY,CAACM,WAAW,EAAE;UACpC,IAAI,CAACC,eAAe,GAAG,GAAGN,GAAG,CAACzB,QAAQ,EAAE,CAACuB,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,IAAII,GAAG,CAAC3B,QAAQ,EAAE,CAACuB,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,IAAIM,GAAG,EAAE;;;IAI3G,CAAC,CAAC;EACJ;EAGOG,MAAM,CAACC,WAAmB,EAAEC,cAAsB;IACvDD,WAAW,EAAE;IACb,IAAI,CAACE,KAAK,GAAG,IAAI;IACjB,IAAIF,WAAW,IAAIC,cAAc,EAAE;MACjC,IAAI,CAACvD,UAAU,GAAG,IAAI;;EAG1B;EAEOyD,SAAS,CAACnD,EAAU;IACzB,IAAI,CAACR,oBAAoB,EAAE;IAC3B,IAAI,CAAC0D,KAAK,GAAG,KAAK;IAClB,IAAI,IAAI,CAAC1D,oBAAoB,IAAI,IAAI,CAACC,kBAAkB,EAAE;MACxD,IAAI,CAACC,UAAU,GAAG,IAAI;;EAE1B;;AAxFWV,8BAA8B;mBAA9BA,8BAA8B;AAAA;AAA9BA,8BAA8B;QAA9BA,8BAA8B;EAAAoE;EAAAC;EAAAC;EAAAC;EAAAC;IAAA;MCZ3CzE,8BAAuB;MACUA,uBAAO;MAAAA,iBAAK;MACzCA,8BAAsB;MAClBA,yBAAyB;MACzBA,8BAAmB;MACfA,+EA0CM;MACVA,iBAAM;MACNA,yBAAyB;MAC7BA,iBAAM;;;MA7CwBA,eAAQ;MAARA,kCAAQ","names":["forkJoin","i0","ListaEventoVoluntarioComponent","constructor","service","router","sessionStorage","getItem","ngOnInit","getListadoEventos","contador_voluntarios","maximo_voluntarios","isDisabled","detalle","idEvento","console","log","getDetalle","id","subscribe","response","fecha","Date","resp","FECHA_INICIO","hora","HORA_INICIO","observables","localStorage","setItem","NOMBRE","UBICACION","OBSERVACIONES","toString","VOLUNTARIOS","MAX_VOLUNTARIOS","ENTIDAD_ORGANIZADORA","NUM_EMBARCACIONES","NUM_MOTOS","NUM_PATRONES","NUM_TRIPULANTES","NUM_SOCORRISTAS","USER_JOINED","navigate","getActividades","i","length","ES_FORMACION","hora_inicio","horas","getHours","minutos","getMinutes","segundos","getSeconds","horaFormateada","padStart","fecha_inicio","dia","getDate","mes","getMonth","any","getFullYear","fechaFormateada","unirse","voluntarios","voluntariosMax","unido","desunirse","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["D:\\VDLM\\src\\app\\views\\lista-evento-voluntario\\lista-evento-voluntario.component.ts","D:\\VDLM\\src\\app\\views\\lista-evento-voluntario\\lista-evento-voluntario.component.html"],"sourcesContent":["import { Component } from '@angular/core';\r\nimport { ActividadesService } from 'src/app/services/actividades.service';\r\nimport { Actividades } from 'src/app/models/actividades';\r\nimport { Router } from '@angular/router';\r\nimport { forkJoin } from 'rxjs';\r\n\r\n\r\n@Component({\r\n  selector: 'app-lista-evento-voluntario',\r\n  templateUrl: './lista-evento-voluntario.component.html',\r\n  styleUrls: ['./lista-evento-voluntario.component.css']\r\n})\r\nexport class ListaEventoVoluntarioComponent {\r\n  public maximo_voluntarios: number = 30;\r\n  public contador_voluntarios: number = 15;\r\n  public resp: Actividades[] = [];\r\n  public isDisabled: boolean = false;\r\n  public unido: boolean = false;\r\n  public id: any = sessionStorage.getItem('id');\r\n  public horaFormateada: string = \"\";\r\n  public fechaFormateada: string = \"\";\r\n\r\n  public constructor(public service: ActividadesService, private router: Router) { }\r\n \r\n  ngOnInit() {\r\n    this.getListadoEventos();\r\n    if (this.contador_voluntarios >= this.maximo_voluntarios) {\r\n      this.isDisabled = true;\r\n    }\r\n  }\r\n\r\n  public detalle(idEvento: number) {\r\n    console.log(idEvento);\r\n    this.service.getDetalle(idEvento, this.id).subscribe(response => {\r\n      console.log(response);\r\n      let fecha = new Date(this.resp[0].FECHA_INICIO);\r\n      let hora = new Date(this.resp[0].HORA_INICIO);\r\n      const observables = [\r\n        localStorage.setItem('nombre_evento', this.resp[0].NOMBRE),\r\n        localStorage.setItem('lugar_evento', this.resp[0].UBICACION),\r\n        localStorage.setItem('descripcion_evento', this.resp[0].OBSERVACIONES),\r\n        localStorage.setItem('fecha_inicio_evento', fecha.toString()),\r\n        localStorage.setItem('hora_inicio_evento', hora.toString()),\r\n        localStorage.setItem('voluntarios_evento', this.resp[0].VOLUNTARIOS.toString()),\r\n        localStorage.setItem('max_voluntarios_evento', this.resp[0].MAX_VOLUNTARIOS.toString()),\r\n        localStorage.setItem('entidad_organizadora', this.resp[0].ENTIDAD_ORGANIZADORA),\r\n        localStorage.setItem('num_embarcaciones', this.resp[0].NUM_EMBARCACIONES.toString()),\r\n        localStorage.setItem('num_motos', this.resp[0].NUM_MOTOS.toString()),\r\n        localStorage.setItem('num_patrones', this.resp[0].NUM_PATRONES.toString()),\r\n        localStorage.setItem('num_tripulantes', this.resp[0].NUM_TRIPULANTES.toString()),\r\n        localStorage.setItem('num_socorristas', this.resp[0].NUM_SOCORRISTAS.toString()),\r\n        localStorage.setItem('user_joined', this.resp[0].USER_JOINED.toString())\r\n      ];\r\n      \r\n      // Combina los observables en uno solo y espera a que todos se completen\r\n      forkJoin(observables).subscribe(() => {\r\n        // Todos los setItem() se han completado, podemos cambiar de ruta\r\n        this.router.navigate(['/detalle_eventos']);\r\n      });\r\n    });\r\n    this.router.navigate(['/detalle_eventos']);\r\n  }\r\n\r\n  public getListadoEventos() {\r\n    this.service.getActividades(this.id).subscribe((response: any[]) => {\r\n      for (let i = 0; i < response.length; i++) {\r\n        if (response[i].ES_FORMACION != true) {\r\n          this.resp = response;\r\n          let hora_inicio = new Date(this.resp[0].HORA_INICIO);\r\n          let horas = hora_inicio.getHours();\r\n          let minutos = hora_inicio.getMinutes();\r\n          let segundos = hora_inicio.getSeconds();\r\n          this.horaFormateada = `${horas.toString().padStart(2, '0')}:${minutos.toString().padStart(2, '0')}:${segundos.toString().padStart(2, '0')}`;\r\n          let fecha_inicio = new Date(this.resp[0].FECHA_INICIO);\r\n          let dia = fecha_inicio.getDate();\r\n          let mes = fecha_inicio.getMonth() + 1;\r\n          let any = fecha_inicio.getFullYear();\r\n          this.fechaFormateada = `${dia.toString().padStart(2, '0')}/${mes.toString().padStart(2, '0')}/${any}`;\r\n        }\r\n      }\r\n\r\n    })\r\n  }\r\n\r\n\r\n  public unirse(voluntarios: number, voluntariosMax: number) {\r\n    voluntarios++;\r\n    this.unido = true;\r\n    if (voluntarios >= voluntariosMax) {\r\n      this.isDisabled = true;\r\n    }\r\n\r\n  }\r\n\r\n  public desunirse(id: number) {\r\n    this.contador_voluntarios--;\r\n    this.unido = false;\r\n    if (this.contador_voluntarios >= this.maximo_voluntarios) {\r\n      this.isDisabled = true;\r\n    }\r\n  }\r\n\r\n}\r\n","<div class=\"container\">\r\n    <h2 class=\"text-center mt-3\">EVENTOS</h2>\r\n    <div class=\"row mt-4\">\r\n        <div class=\"col-2\"></div>\r\n        <div class=\"col-8\">\r\n            <div *ngFor=\"let item of resp let i = index\">\r\n                <div *ngIf=\"item.ES_FORMACION == false\">\r\n                    <div class=\"card mb-5\">\r\n                        <div class=\"card-body\">\r\n                            <h4 class=\"card-title\">{{item.NOMBRE}}</h4>\r\n                            <p class=\"card-text\">{{item.OBSERVACIONES}}</p>\r\n                            <span id=\"datoResaltado\">LUGAR</span>\r\n                            <p>{{item.UBICACION}}</p>\r\n                            <div class=\"row\">\r\n                                <div class=\"col\">\r\n                                    <span id=\"datoResaltado\">FECHA INICIO</span>\r\n                                    <p>{{fechaFormateada}}</p>\r\n                                </div>\r\n                                <div class=\"col\">\r\n                                    <span id=\"datoResaltado\">HORA INICIO</span>\r\n                                    <p>{{horaFormateada}}</p>\r\n                                </div>\r\n                            </div>\r\n                            <p>Voluntarios: <span id=\"datoResaltado\">{{item.VOLUNTARIOS}} /\r\n                                    {{item.MAX_VOLUNTARIOS}}</span></p>\r\n                            <div class=\"d-grid gap-2 d-md-block\">\r\n                                <button \r\n                                    (click)=\"detalle(item.ID)\" class=\"btn mt-1 btn-md\" id=\"botonesListado\"\r\n                                    style=\"background-color: lightblue;\" type=\"button\">VER</button>\r\n                                <button *ngIf=\"unido==false; else elseBlock\"\r\n                                    [ngStyle]=\"{'pointer-events': isDisabled ? 'none' : 'auto'}\" [disabled]=\"isDisabled\"\r\n                                    (click)=\"unirse(item.VOLUNTARIOS,item.MAX_VOLUNTARIOS)\" class=\"btn mt-1 btn-md\"\r\n                                    id=\"botonesListado\" style=\"background-color: #0066ff; color: white\"\r\n                                    type=\"button\">PARTICIPAR</button>\r\n\r\n                                <ng-template #elseBlock>\r\n                                    <button class=\"btn mt-1 btn-md\" id=\"botonesListado\"\r\n                                        style=\"background-color: green; color: white\" type=\"button\">SE HA UNIDO AL\r\n                                        EVENTO</button>\r\n                                    <button (click)=\"desunirse(item.ID)\" class=\"btn mt-1 btn-md\" id=\"botonesListado\"\r\n                                        style=\"background-color: red; color: white\" type=\"button\">ABANDONAR</button>\r\n                                </ng-template>\r\n\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"col-2\"></div>\r\n    </div>\r\n</div>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}